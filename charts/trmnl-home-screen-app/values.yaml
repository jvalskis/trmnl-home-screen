defaultPodOptions:
  automountServiceAccountToken: false
  securityContext:
    runAsUser: 1001
    runAsNonRoot: true

controllers:
  main:
    strategy: Recreate
    containers:
      main:
        image:
          repository: ghcr.io/jvalskis/trmnl-home-screen-app
          # Defaults to .Chart.AppVersion
          tag:
          pullPolicy: IfNotPresent
        env:
          TZ: UTC
          WEATHER_ENABLED: "true"
          WEATHER_CITY: "London"
          WEATHER_FETCH_INTERVAL_MINUTES: "60"
          WEATHER_TEMPLATE_FILE: "/app/templates/weather.liquid"
          ACCUWEATHER_API_KEY: YOUR_API_KEY
#            valueFrom:
#              secretKeyRef:
#                name: ""
#                key: ACCUWEATHER_API_KEY
          CALENDAR_ENABLED: "true"
          CALDAV_CALENDAR_URL: "https://nextcloud.example.com/remote.php/dav/calendars/user/personal/"
          CALDAV_AUTH_TYPE: "basic"
          CALDAV_USERNAME: "user"
          CALDAV_PASSWORD: "app-password"
          CALDAV_FETCH_INTERVAL_MINUTES: "30"
          CALDAV_DAYS_AHEAD: "7"
          CALENDAR_TEMPLATE_FILE: "/app/templates/calendar.liquid"
        securityContext:
          readOnlyRootFilesystem: true
          allowPrivilegeEscalation: false
          capabilities:
            drop:
              - ALL
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 500m
            memory: 512Mi

service:
  main:
    controller: main
    type: ClusterIP
    ports:
      http:
        port: 8080

persistence:
  tmp:
    type: emptyDir
    globalMounts:
      - path: /tmp
